CPR-nummerteori

2006-01-27 Lars Sommer, lasg@lasg.dk

Matematikken bag, til fremstilling af scripts der kan tjekke gyldighed eller 
 generere lister af gyldige CPR-numre.


Først findes et mellemresultat bestående af fødselsdatoen ganget med en
 række bestemte cifre.
I fødselsdatoen på formatet dato-måned-år, ddmmyy, skal cifrene ganges
 med hhv 4, 3, 2, 7, 6, 5
Og hver udregning lægges sammen. Som:
d*4 + d*3 + m*2 + m*7 + y*6 + y*5

Taleksempel:
Datoen 161284, ddmmyy, skal ganges med hhv, 4, 3, 2, 7, 6, 5
1*4 + 6*3 + 1*2 + 2*7 + 8*6 + 4*5  =  4 + 18 + 2 + 14 + 48 + 20  =  106

Lad os kalde dette resultat grundtest.


Så tager vi et gennemløb af en række variable, a, b, c og d.
De løber fra 0 til 9. 
d er speciel, da den består af ulige tal mellem 0 og 9 for mænd,
og lige tal mellem 0 og 9 for kvinder.

Lad dem ændre sig een ad gangen, som ala:

for (a = 0; a <= 9; a++){
	for (b = 0; b <= 9; b++){
		for (c = 0; c <= 9; c++){
			for (d = {0 hvis kvinde, 1 hvis mand}; d <= 9; d=d+2){

Så skal vi gange a, b, c og d med hhv 4, 3, 2 og 1;
a b c d
4 3 2 1
Starteksempel: 0001 for mænd, derefter 0003, 0005 osv op til 9999
 (og 9998 for kvinder)

Dette resultat kan vi kalde plustest.

Plustest er de fire sidste cifre i cpr-nummeret. Selvfølgelig kan man ikke
 bruge alle abcd'er hertil, hvorfor vi må teste om den aktuelle plustest
 er gyldig. Det gør vi med det der hedder et modulus11-tjek.

Vi adderer grundtest og plustest, og tager modulus 11 til dette:
( grundtest + plustest ) % 11

Modulus vil sige at vi deler med 11, og kun gemmer resten i denne division.

Hvis der er en rest, så er vores abcd ikke gyldige. Eksempelvis:
( 106 + 1 ) % 11  =  8, altså ugyldig.

Hvis modulus11-tjekket giver 0, så er et det gyldigt cpr-nummer på
 formen ddmmyy-abcd.

Eksempelvis:
a=1, b=2, c=1, d=3
plustest = 1*4 + 2*3 + 1*2 + 3*1 = 15
( 106 + 15 ) % 11 = 121 % 11 = 0
Altså er 161284-1213 et gyldigt nummer.


